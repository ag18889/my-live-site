<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>äº¤æ˜“æ‰€èµ„äº§æ€»è§ˆç”Ÿæˆå™¨ V20.0 (ç»ˆæå®Œç¾ç‰ˆ)</title>
    <base href="https://ag18889.github.io/my-live-site/"> 
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
        /* é¢œè‰²å®šä¹‰ */
        :root {
            --text-color: #333;
            --light-gray: #f0f2f5;
            --binance-yellow: #fcd535;
            --green: #00b97b;
            --red: #f6465d;
            --dark-bg: #2c2c2c;
            --soft-black: #1a1a1a;
        }
        /* 1. æ•´ä½“å¸ƒå±€ï¼šå·¦å³åˆ†æ  */
        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background-color: var(--light-gray);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
        }

        #container {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }

        /* 2. æ¨¡æ‹Ÿ App ç•Œé¢ (æˆªå›¾åŒºåŸŸ) */
        #mock-app {
            width: 375px; 
            height: 812px; 
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            background-color: #ffffff; 
            color: var(--text-color); 
            position: relative;
            display: flex;
            flex-direction: column;
            border: 8px solid var(--soft-black); 
            transition: all 0.3s;
            border-radius: 40px; 
        }

        /* æ‰‹æœºæ ·å¼åˆ‡æ¢ CSS */
        .standard-bar { border-radius: 12px !important; border-width: 0px !important; }
        .standard-bar .top-bar { padding: 10px 15px !important; }
        .standard-bar .notch { display: none !important; }

        .top-bar { position: relative; z-index: 5; display: flex; justify-content: space-between; align-items: center; padding: 12px 20px 8px 20px; font-size: 15px; font-weight: 600; color: var(--text-color); background: #ffffff; }
        .top-bar-right { display: flex; gap: 5px; align-items: center; font-size: 13px; }
        .notch { width: 100px; height: 25px; background: black; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; position: absolute; top: 0; left: 50%; transform: translateX(-50%); z-index: 6; transition: all 0.3s; }
        .no-notch { height: 0; visibility: hidden; }

        /* æ ¸å¿ƒå†…å®¹åŒº */
        .content-main { flex-grow: 1; padding: 0 15px; background-color: #ffffff; overflow-y: auto; } /* ç§»é™¤ä¾§è¾¹ padding */
        
        /* å¯¼èˆªåŒº */
        .main-nav { display: flex; gap: 20px; font-size: 16px; font-weight: 600; padding: 10px 0 20px 10px; margin-top: 5px; } /* ä¿®æ­£å­—å·/ç²—ç»† */
        .main-nav-item { color: #999; cursor: pointer; font-weight: 600;}
        .main-nav-item.active { color: var(--soft-black); font-weight: 700; position: relative; }
        .main-nav-item.active::after { content: ''; position: absolute; left: 0; bottom: -5px; width: 100%; height: 3px; background-color: var(--binance-yellow); border-radius: 2px; }

        /* èµ„äº§ä¿¡æ¯åŒº */
        .asset-summary { margin-bottom: 25px; padding: 0 10px; } 
        .asset-summary h3 { font-size: 14px; font-weight: 500; color: #999; margin: 0 0 5px 0; display: flex; align-items: center; gap: 5px; }
        .asset-summary h1 { font-size: 32px; font-weight: 700; margin: 0; padding: 0; display: flex; align-items: baseline; gap: 8px; }
        .asset-summary h1 span { font-size: 16px; font-weight: 500; color: #999; } /* ä¿®æ­£ 1: USD ç¬¦å·æ ·å¼ */
        
        /* ç›ˆäºæ ·å¼è°ƒæ•´ */
        .profit-loss-summary {
            font-size: 15px;
            color: var(--text-color); 
            gap: 5px;
            margin-top: 5px; 
            margin-bottom: 0;
            padding: 0;
            font-weight: 500;
        }
        .pl-value { font-weight: 500; }
        .pl-value.green { color: var(--green); }
        .pl-value.red { color: var(--red); }
        .pl-arrow { color: #999; margin-left: 5px; } /* ä¿®æ­£ 2: ç›ˆäºå³ä¾§ç®­å¤´æ ·å¼ */


        /* æ“ä½œæŒ‰é’®ç»„ CSS */
        .action-buttons { display: flex; gap: 10px; margin: 25px 10px 30px 10px; } 
        .action-btn { padding: 10px 15px; border-radius: 5px; font-size: 15px; font-weight: 600; text-align: center; }
        .action-btn:nth-child(1) { background-color: var(--binance-yellow); color: var(--soft-black); width: 35%; }
        .action-btn.secondary { background-color: var(--light-gray); color: var(--soft-black); width: 32.5%; }

        /* èµ„äº§åˆ—è¡¨åŒº */
        .asset-list-header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 10px 10px 10px 10px; 
            border-bottom: 1px solid #f0f2f5; 
            font-size: 15px; font-weight: 500; /* ä¿®æ­£ 3: åˆ—è¡¨å¤´æ–‡å­—æ›´ç»† */
            color: #999;
            margin-bottom: 0; 
        }
        .asset-list-item { 
            display: flex; justify-content: space-between; 
            padding: 15px 10px; 
            font-size: 16px; 
            border-bottom: 1px solid #f0f2f5; 
        }
        .asset-list-label { color: var(--text-color); font-weight: 500; } /* ä¿®æ­£ 3: åˆ—è¡¨ label å­—ä½“æ›´ç»† */
        .asset-list-value { font-weight: 600; color: var(--text-color); } 
        .asset-list-value.contract-value { margin-left: 5px; } /* åˆçº¦ä½™é¢æ²¡æœ‰ $ ç¬¦å·ï¼Œä¿®æ­£ 5 */

        /* åº•éƒ¨å¯¼èˆªæ  */
        .nav-bar { display: flex; justify-content: space-around; padding: 8px 0; border-top: 1px solid #eee; background: #ffffff; width: 100%; height: 60px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #999; }
        .nav-icon { font-size: 24px; margin-bottom: 3px; line-height: 1; font-family: inherit; }
        .nav-item.active { color: var(--soft-black); font-weight: 600; }
        .nav-item.active .nav-icon { color: var(--binance-yellow); }

        /* 3. ç¼–è¾‘åŒºåŸŸ */
        #editor { padding: 25px; background-color: var(--dark-bg); border-radius: 8px; color: #ccc; width: 350px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        #editor input, #editor select { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 4px; border: 1px solid #555; background-color: #444; color: white; box-sizing: border-box; }
        #editor input[readonly] { background-color: #555; cursor: not-allowed; }
        #editor label { display: block; margin-bottom: 5px; font-size: 14px; color: #999; }
        #save-button { width: 100%; padding: 12px; background-color: var(--binance-yellow); color: var(--soft-black); border: none; border-radius: 4px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; }
        #calculated-result { padding: 10px; background-color: #1a1a1a; border-radius: 4px; margin-bottom: 15px; font-size: 14px; }
    </style>
</head>
<body>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <div id="container">
        <div id="editor">
            <h3>ğŸ“± æ‰‹æœºæ ·å¼</h3>
            <label for="select-phone-style">æ‰‹æœºæ ·å¼</label>
            <select id="select-phone-style">
                <option value="notch">è‹¹æœåˆ˜æµ·å± (iPhone)</option>
                <option value="standard-bar" selected>æ ‡å‡†åœ†è§’ (Android)</option>
            </select>
            
            <label for="input-custom-time">è‡ªå®šä¹‰æ—¶é—´ (å¦‚ 15:58)</label>
            <input type="text" id="input-custom-time" value="15:58">
            
            <hr style="border-color: #555; margin: 20px 0;">

            <h3>ğŸ’° èµ„äº§æ•°æ®ç¼–è¾‘</h3>
            <label for="input-total-asset">é¢„ä¼°æ€»èµ„äº§ ($)</label>
            <input type="text" id="input-total-asset" value="2250870.69">

            <label for="input-pl-amount">ä»Šæ—¥ç›ˆäºé‡‘é¢ ($)</label>
            <input type="text" id="input-pl-amount" value="115780.017">

            <label for="select-pl-color">ä»Šæ—¥ç›ˆäºçŠ¶æ€</label>
            <select id="select-pl-color">
                <option value="green">ç›ˆåˆ© (ç»¿)</option>
                <option value="red">äºæŸ (çº¢)</option>
            </select>

            <label for="input-spot">ç°è´§ä½™é¢ ($)</label>
            <input type="text" id="input-spot" value="893718.69">
            
            <label for="input-funding">èµ„é‡‘ä½™é¢ ($)</label>
            <input type="text" id="input-funding" value="1298810.05">

            <div id="calculated-result">åˆçº¦ä½™é¢ (è‡ªåŠ¨è®¡ç®—): <span>$58,341.95</span></div>
            
            <label for="input-future">åˆçº¦ä½™é¢ ($) - è‡ªåŠ¨è®¡ç®—</label>
            <input type="text" id="input-future" value="58341.95" readonly>


            <hr style="border-color: #555; margin: 20px 0;">
            <button id="save-button">ä¸€é”®ä¿å­˜ä¸º PNG å›¾ç‰‡</button>
        </div>

        <div id="mock-app">
            <div id="phone-notch" class="notch"></div> 
            
            <div class="top-bar">
                <span id="current-time">15:58</span>
                <span style="font-size: 18px; margin-left: 5px;"><i class="fas fa-user-alt"></i></span> 
                <div class="top-bar-right">
                    <i class="fas fa-signal"></i>
                    <i class="fas fa-wifi"></i>
                    <span style="font-size: 12px; font-weight: 600;">100</span><i class="fas fa-battery-full"></i>
                </div>
            </div>

            <div class="content-main">
                <div class="main-nav">
                    <span class="main-nav-item active">æ€»è§ˆ</span>
                    <span class="main-nav-item">ç°è´§</span>
                    <span class="main-nav-item">èµ„é‡‘</span>
                    <span class="main-nav-item">åˆçº¦</span>
                </div>

                <div class="asset-summary">
                    <h3>é¢„ä¼°æ€»èµ„äº§ <i id="eye-icon" class="fas fa-eye"></i></h3>
                    <h1 id="total-asset-output">$2,250,870.69<span> USD <i class="fas fa-chevron-down" style="font-size: 14px;"></i></span></h1>
                    <p class="profit-loss-summary" id="pl-summary-output">
                        ä»Šæ—¥ç›ˆäº <span id="pl-value-output" class="pl-value green">+$115,780.017 (5.14%)</span> <span class="pl-arrow">></span>
                    </p>
                </div>

                <div class="action-buttons">
                    <span class="action-btn">æ·»åŠ èµ„é‡‘</span>
                    <span class="action-btn secondary">è½¬å‡º</span>
                    <span class="action-btn secondary">åˆ’è½¬</span>
                </div>

                <div class="asset-list-header">
                    <span style="padding-bottom: 5px; border-bottom: 2px solid var(--binance-yellow);">å¸ç§ è´¦æˆ·</span>
                    <span><i class="fas fa-lock"></i></span>
                </div>

                <div class="asset-list">
                    <div class="asset-list-item">
                        <span class="asset-list-label">ç°è´§</span>
                        <span id="spot-output" class="asset-list-value">$893,718.69</span>
                    </div>
                    <div class="asset-list-item">
                        <span class="asset-list-label">èµ„é‡‘</span>
                        <span id="funding-output" class="asset-list-value">$1,298,810.05</span>
                    </div>
                    <div class="asset-list-item" style="border-bottom: none;">
                        <span class="asset-list-label">åˆçº¦</span>
                        <span id="future-output" class="asset-list-value contract-value">58,341.95</span> </div>
                </div>
            </div>
            
            <div class="nav-bar">
                <div class="nav-item">
                    <span class="nav-icon">âŸ¡</span> <span>é¦–é¡µ</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">ğŸ“ˆ</span> <span>è¡Œæƒ…</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">ğŸ”„</span> <span>äº¤æ˜“</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">ğŸ“œ</span> <span>åˆçº¦</span>
                </div>
                <div class="nav-item active">
                    <span class="nav-icon">ğŸ“</span> <span>èµ„äº§</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const MIN_TOTAL_ASSET = 50000; 

        // --- å…ƒç´ å¼•ç”¨ ---
        const mockApp = document.getElementById('mock-app');
        const saveButton = document.getElementById('save-button');
        const phoneNotch = document.getElementById('phone-notch');
        const phoneStyleSelect = document.getElementById('select-phone-style');
        const calculatedResult = document.getElementById('calculated-result');
        const totalAssetInput = document.getElementById('input-total-asset');
        const plAmountInput = document.getElementById('input-pl-amount');
        const plColorSelect = document.getElementById('select-pl-color');
        const spotInput = document.getElementById('input-spot');
        const fundingInput = document.getElementById('input-funding');
        const customTimeInput = document.getElementById('input-custom-time');

        // è¾“å‡º
        const timeOutput = document.getElementById('current-time');
        const totalAssetOutput = document.getElementById('total-asset-output');
        const plValueOutput = document.getElementById('pl-value-output'); 
        const spotOutput = document.getElementById('spot-output');
        const fundingOutput = document.getElementById('funding-output');
        const futureOutput = document.getElementById('future-output');


        // --- å·¥å…·å‡½æ•°ï¼šæ¸…ç†å’Œæ ¼å¼åŒ–æ•°å­— ---
        function cleanNumber(numStr) {
            return parseFloat(numStr.replace(/[^0-9.]/g, '')) || 0;
        }

        function formatNumber(num) {
            if (isNaN(num)) return '0.00';
            return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 10 });
        }


        // --- ä¸»æ›´æ–°å‡½æ•° ---
        function updateDisplay() {
            // 1. é¡¶éƒ¨æ—¶é—´
            timeOutput.textContent = customTimeInput.value;

            // 2. æ‰‹æœºæ ·å¼
            const style = phoneStyleSelect.value;
            phoneNotch.className = style === 'notch' ? 'notch' : 'no-notch';
            mockApp.className = style === 'standard-bar' ? 'standard-bar' : '';

            // 3. æ ¡éªŒå¹¶è·å–æ€»èµ„äº§ (å¼ºåˆ¶æœ€ä½ $50k)
            let totalAssetRaw = cleanNumber(totalAssetInput.value);
            let displayTotalAsset = totalAssetRaw;
            
            let assetWarning = '';
            if (totalAssetRaw < MIN_TOTAL_ASSET) {
                assetWarning = `<span class="warning">âš ï¸ è­¦å‘Š: æ€»èµ„äº§ä½äº $${formatNumber(MIN_TOTAL_ASSET)}ï¼Œå·²å¼ºåˆ¶æ˜¾ç¤º $${formatNumber(MIN_TOTAL_ASSET)}ã€‚</span>`;
                displayTotalAsset = MIN_TOTAL_ASSET;
            }
            
            // 4. èµ„é‡‘å¹³è¡¡è®¡ç®—
            const spotBalance = cleanNumber(spotInput.value);
            const fundingBalance = cleanNumber(fundingInput.value);

            const futureBalance = displayTotalAsset - spotBalance - fundingBalance;

            // 5. ç›ˆäºé¢œè‰²/ç¬¦å·/ç™¾åˆ†æ¯”
            const plAmount = cleanNumber(plAmountInput.value);
            const plColorClass = plColorSelect.value;
            const plSign = plColorSelect.value === 'red' ? '-' : '+';

            let plPercent = 0.00;
            if (displayTotalAsset !== 0 && !isNaN(plAmount)) {
                plPercent = Math.abs((plAmount / displayTotalAsset) * 100).toFixed(2);
            }

            const formattedPlAmount = formatNumber(plAmount);
            
            // 6. æ›´æ–° App ç•Œé¢
            
            // æ€»èµ„äº§
            totalAssetOutput.textContent = `$${formatNumber(displayTotalAsset)}`;
            
            // ç›ˆäºå€¼å’Œé¢œè‰²
            plValueOutput.textContent = `${plSign}$${formattedPlAmount} (${plSign}${plPercent}%)`;
            plValueOutput.className = `pl-value ${plColorClass}`;
            
            // ç°è´§å’Œèµ„é‡‘
            spotOutput.textContent = `$${formatNumber(spotBalance)}`;
            fundingOutput.textContent = `$${formatNumber(fundingBalance)}`;

            // åˆçº¦ä½™é¢ (é˜²è´Ÿæ•°)
            let calculationMessage = '';
            let contractValueOutput = formatNumber(futureBalance);

            if (futureBalance < 0) {
                 calculationMessage = `<span class="error">âŒ é”™è¯¯: ç°è´§+èµ„é‡‘è¶…è¿‡æ€»èµ„äº§ ($${formatNumber(Math.abs(futureBalance))})ã€‚è¯·è°ƒæ•´ã€‚</span>`;
                 contractValueOutput = '0.00'; 
            } else {
                 calculationMessage = `åˆçº¦ä½™é¢ (è‡ªåŠ¨è®¡ç®—): <span>$${formatNumber(futureBalance)}</span>`;
            }
            
            // 7. æ›´æ–°æ§åˆ¶é¢æ¿å’Œ App åˆçº¦ä½™é¢ (æ³¨æ„ï¼šä¸åŠ  $)
            futureOutput.textContent = contractValueOutput; // ä¿®æ­£ 5: åˆçº¦ä½™é¢ä¸å¸¦ $
            calculatedResult.innerHTML = assetWarning + calculationMessage;
        }
        
        // --- ä¿å­˜å›¾ç‰‡å‡½æ•° (ä¿æŒä¸å˜) ---
        function saveScreenshot() {
            saveButton.disabled = true;
            saveButton.textContent = 'æ­£åœ¨ç”Ÿæˆä¸­...';
            
            const originalBorder = mockApp.style.border;
            const originalBorderRadius = mockApp.style.borderRadius;
            const originalClassName = mockApp.className;

            mockApp.style.border = 'none';
            mockApp.style.borderRadius = '0px';
            mockApp.className = ''; 

            const navBar = document.querySelector('.nav-bar');
            navBar.style.display = 'none'; 

            html2canvas(mockApp, {
                allowTaint: true, 
                useCORS: true,
                backgroundColor: '#ffffff',
                scale: window.devicePixelRatio,
            }).then(canvas => {
                const imageURL = canvas.toDataURL("image/png");
                const link = document.createElement('a');
                link.href = imageURL;
                link.download = 'exchange_asset_summary_screenshot.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // æ¢å¤æ ·å¼
                mockApp.style.border = originalBorder;
                mockApp.style.borderRadius = originalBorderRadius;
                mockApp.className = originalClassName;
                navBar.style.display = 'flex'; 

                saveButton.disabled = false;
                saveButton.textContent = 'ä¸€é”®ä¿å­˜ä¸º PNG å›¾ç‰‡';
            }).catch(err => {
                 saveButton.disabled = false;
                 saveButton.textContent = 'ç”Ÿæˆå¤±è´¥ï¼Œè¯·æˆªå›¾';
                 console.error("ç”Ÿæˆå›¾ç‰‡æ—¶å‡ºé”™:", err);
                 // æ¢å¤æ ·å¼
                 mockApp.style.border = originalBorder;
                 mockApp.style.borderRadius = originalBorderRadius;
                 mockApp.className = originalClassName;
                 navBar.style.display = 'flex'; 
            });
        }

        // --- ç›‘å¬æ‰€æœ‰å˜åŒ– ---
        updateDisplay(); 
        customTimeInput.addEventListener('input', updateDisplay);
        totalAssetInput.addEventListener('input', updateDisplay);
        plAmountInput.addEventListener('input', updateDisplay);
        plColorSelect.addEventListener('change', updateDisplay);
        spotInput.addEventListener('input', updateDisplay);
        fundingInput.addEventListener('input', updateDisplay);
        phoneStyleSelect.addEventListener('change', updateDisplay);
        saveButton.addEventListener('click', saveScreenshot);

    </script>
</body>
</html>
